\chapter{Тестирование и апробация} \label{ch4}

В этой главе в параграфах \ref{ch4:sec1} и \ref{ch4:sec2} речь пойдёт о проводимом тестировании системы составления предварительного расписания сессии СПбПУ, а в параграфе \ref{ch4:sec3} о её апробации в период весенней сессии 20-21 учебного года.

\section{Функциональное тестирование} \label{ch4:sec1}
Для проверки того, что разработанная система выполняет все требуемые функции, было проведено ручное функциональное тестирование. Для этого были созданы несколько искусственных вариантов входных файлов, содержащих данные о типах аттестаций, учебных планах направлений и список аудиторий. С их помощью было проверены следующие функциональности:
\begin{itemize}
	\item при загрузке файла с аудиториями данные из него корректно сохраняются в базе данных и пользователю отображается новый список;
	\item при загрузке файла с учебным планом для конкретной специальности, в базе данных обновляется информация только по выбранной специальности;
	\item при загрузке файла с типами аттестаций информация из него сохраняется в базе данных, перетирая предыдущие данные о типах мероприятий, и отображается пользователю.
\end{itemize} 	

Также на тестовой google-таблице с данными о событиях с установленными датой, временем и аудиторией была проверена возможность учитывать эти данные, как константу при составлении остального расписания.

При выборе дат и времени в формах редактирования сессии, была проверена корректность обновления этих данных в базе данных и отображение их пользователю. Входные данные подбирались таким образом, чтобы было видно, что данные с сайта с расписанием учебных занятий \cite{ruz} учитываются при генерации нового расписания.

Для проектов, разрабатываемых длительное время командой программистов, вместо ручного тестирования следовало бы использовать автоматизированное, но для данного проекта разработка самих автотестов заняла бы больше времени, чем ручное их прохождение. Проводимые тесты воспроизводили сценарии работы с системой составления предварительного расписания сессии, и показали, что с точки зрения пользователя она выполняет все заявленные функции.

\section{Unit-тестирование} \label{ch4:sec2}

Для отладки и финальной проверки правильности работы отдельных методов программы использовалось модульное тестирование. Насписание тестов позволяет на ранних этапах разработки отсекать ошибки, что повышает производительность и ускоряет процесс создания системы, так как корректность отдельных программных блоков проверяется сразу же, исключая ситуацию с переписыванием большого количества кода, вызванную чередой вовремя не замеченных багов.

Для написания модульных тестов использовался java-фреймворк jUnit. Был создан тестовый класс SchedulerTest, код которого находится в приложении \ref{appendix-test}. Данный класс содержит методы, помеченные аннотацией @Test, в которых выполнение некоторого условия проверяется с мощью методов класса Assert. Класс Assert фреймворка jUnit имеет множество методов, удобных для сверки ожидаемого результата проверяемой функции с реальным. Так, assertArrayEquals позволяет сравнивать содержимое массивов, assertNull - равенство null, assertEquals - любое равенство и так далее. При невыполнении условий такие тесты выбрасывают исключение, что даёт разработчику сигнал о том, что изменения кода внесли ошибки в старый код, и прежде чем приступать к следующим, нужно доработать эти. Таким образом, с помощью модульного тестирования была проверена корректность работы алгоритма составленения предварительного расписания при разных наборах входных данных, что подтвердило его работоспособность и в случаях, когда расписание можно составить с учётом всех пожеланий, и когда приходится игнорировать некоторые пожелания, и когда расписание невозможно составить в принципе. 

\section{Апробация} \label{ch4:sec3}
Апробация системы составления предварительного расписания проводилась на весенней сессии 2020-2021 учебного года. 

Первый этап апробации заключался в составлении расписания экзаменов для студентов 4-ых курсов направлений 02.03.03 и 09.03.03. Форма для сбора пожеланий преподавателей была выполнена с помощью сервиса Microsoft Forms, так как это позволяло автоматически определять адреса электронных почт и имена респондентов. На этом этапе были выявлены несколько её недостатков:

\begin{itemize}
	\item форма одинакова для всех преподавателей, и для того чтобы указать необходимые типы аудиторий преподавателю приходилось выбирать из огромного списка только те группы и дисциплины, у которых он проводит аттестации;
	\item имена ассистентов, введённые в поле респондентами не всегда соответствовали именам преподавателей с сайта расписания учебных занятий, что затруднило их маппинг;
	\item одному респонденту приходилось отправлять форму несколько раз для разных аттестаций;
	\item Microsoft Forms не имеет API для чтения собранных результатов;
	\item ручное создание формы заняло много времени.
\end{itemize} 	

Для решения этих проблем было принято решение делать формы с помощью сервиса Google Forms. Его преимуществом перед Microsoft является наличие API, позволяющего полностью автоматизировать как чтение результатов, так и создание самой формы. Теперь каждый преподаватель мог выбрать своё имя, а далее заполнять форму только по своим аттестациям. Также, в новой версии формы был минимизирован ручной ввод информации респондентами. Это решило проблему опечаток и различий введённых имён от имён из расписания. Новая версия формы не требовала повторной отправки, так как все необходимые данные преподаватель может ввести за одну итерацию заполнения формы.

Новый вариант google-формы был опробован при составлении предварительного расписания летней сессии студентов заочной формы обучения специальности Прикладная информатика. 
а также расписания их установочных занятий. Таким образом, были получены две таблицы с расписаними, сгенерованными системой, что продемонстрировало принципиальную применимость разработанной системы к составлению расписания любого мероприятия, занимающего непрерывное время в течение одного учебного дня. 

В качестве входных данных системе подавался список возможных типов аттестаций, включающий их длительность, максимальное кол-во в день и сведения о количестве дней отдыха до и после. Список представлен в таблице \ref{table:att}.
\begin{table}[htbp]
	\centering\small 
	\caption{Типы аттестаций}%
	\begin{tabular}{|l|r|r|r|r|}
		\hline
		Тип аттестации & \multicolumn{1}{l|}{Отдых до} & \multicolumn{1}{l|}{Отдых после} & \multicolumn{1}{l|}{Длительность} & \multicolumn{1}{l|}{Макс. кол-во в день} \\ \hline
		Эк             & 0                             & 0                                & 5                                 & 1                                        \\ \hline
		Зч             & 0                             & 0                                & 3                                 & 2                                        \\ \hline
		ЗчО            & 0                             & 0                                & 3                                 & 2                                        \\ \hline
		Лек2           & 0                             & 0                                & 2                                 & 10                                       \\ \hline
		Лаб2           & 0                             & 0                                & 2                                 & 10                                       \\ \hline
		Пр2            & 0                             & 0                                & 2                                 & 10                                       \\ \hline
		Лек4           & 0                             & 0                                & 4                                 & 10                                       \\ \hline
		Лаб4           & 0                             & 0                                & 4                                 & 10                                       \\ \hline
		Пр4            & 0                             & 0                                & 4                                 & 10                                       \\ \hline
		Кр             & 0                             & 0                                & 3                                 & 10                                       \\ \hline
		Кпр            & 0                             & 0                                & 4                                 & 10                                       \\ \hline
	\end{tabular}
\end{table} \label{table:att}
\FloatBarrier

Для определения того, какие события необходимо учесть в расписании, на вход была подала таблица с учбным планом на летнюю сессию 2021, в которой перечислены учебные группы, дисципллины, типы аттестации и преподаватели, проводящие для них аттестации. Система также может принимать на вход сведения об учебных планах без указания преподавателей. В таком случае сопоставление события и его проводящего происходило бы с помощью данных из расписания ruz.spbstu.ru. Но в данном случае преподаватели были известны, и загруженные данные представлены в таблице \ref{table:plan}.
\begin{table}[htbp]
	\centering\small 
	\caption{План экзаменов летней сессии студентов заочной формы обучения}%
	\begin{tabular}{|p{0.48\linewidth}|p{0.05\linewidth}|p{0.16\linewidth}|p{0.04\linewidth}|p{0.08\linewidth}|}
		\hline
		Дисциплина&Курс&Группа&Тип&ППС \\ 	\hline
		Дифференциальные уравнения                                                    & 1                                                & з3530903/00001                                     & Эк                                                         & ФИО1          \\ 	\hline
		Дифференциальные уравнения                                                    & 1                                                & з3530903/00002                                     & Эк                                                         & ФИО1          \\	\hline
		Дополнительные главы программирования (C\#)                                   & 1                                                & з3530903/00001                                     & Эк                                                         & ФИО2          \\ 	\hline
		Дополнительные главы программирования (C\#)                                   & 1                                                & з3530903/00002                                     & Эк                                                         & ФИО2          \\ 	\hline
		Базы данных                                                                   & 2                                                & з3530903/90001                                     & Эк                                                         & ФИО3          \\	\hline
		Базы данных                                                                   & 2                                                & з3530903/90002                                     & Эк                                                         & ФИО3          \\	\hline
		Структуры и алгоритмы обработки данных                                        & 2                                                & з3530903/90001                                     & Эк                                                         & ФИО6          \\	\hline
		Структуры и алгоритмы обработки данных                                        & 2                                                & з3530903/90002                                     & Эк                                                         & ФИО6          \\	\hline
		Дискретная математика (дополнительные главы)                                  & 2                                                & з3530903/90002                                     & ЗчО                                                        & ФИО6          \\	\hline
		Дискретная математика (дополнительные главы)                                  & 2                                                & з3530903/90001                                     & ЗчО                                                        & ФИО6          \\	\hline
		Учебная практика/Ознакомительная практика                                     & 2                                                & з3530903/90001                                     & Зч                                                         & ФИО7          \\	\hline
		Учебная практика/Ознакомительная практика                                     & 2                                                & з3530903/90002                                     & Зч                                                         & ФИО7          \\	\hline
		Проектирование информационных систем                                          & 4                                                & з3530903/70301                                     & Эк                                                         & ФИО7          \\	\hline
		Проектная деятельность бакалавра                                              & 4                                                & з3530903/70301                                     & Зч                                                         & ФИО8          \\
		Использование и разработка web-сервисов                                       & 4                                                & з3530903/70301                                     & Эк                                                         & ФИО9          \\	\hline
		Использование и разработка web-сервисов                                       & 4                                                & з3530903/70301                                     & Зч                                                         & ФИО9          \\	\hline
		Интеллектуальный анализ данных                                                & 4                                                & з3530903/70301                                     & Эк                                                         & ФИО10         \\ 	\hline
		Интеллектуальный анализ данных                                                & 4                                                & з3530903/70301                                     & Зч                                                         & ФИО10         \\ 	\hline
		Производственная практика/Научно-исследовательская работа                     & 4                                                & з3530903/70301                                     & ЗчО                                                        & ФИО2          \\	\hline
		Администрирование информационных систем (на английском языке)                 & 3                                                & з3530903/80301                                     & Эк                                                         & ФИО11         \\	\hline
		Теория вероятностей и математическая статистика                               & 3                                                & з3530903/80301                                     & Эк                                                         & ФИО1          \\	\hline
		Архитектура вычислительных систем                                             & 3                                                & з3530903/80301                                     & Эк                                                         & ФИО12         \\
		Технологии разработки программного обеспечения (C\#)                          & 3                                                & з3530903/80301                                     & Эк                                                         & ФИО7          \\	\hline
		Программирование веб-приложений (JS)                                          & 3                                                & з3530903/80301                                     & Зч                                                         & ФИО13         \\	\hline
		Производственная практика/Технологическая (проектно-технологическая) практика & 3                                                & з3530903/80301                                     & Зч                                                         & ФИО5  \\	\hline       
	\end{tabular}
\end{table} \label{table:plan}
\FloatBarrier

Далее профессорско-преподавательский состав, участвующий в летней сессии для заочников заполнял google-формы, в которых называли предпочтительный для себя интервал дат для проведения сессии, интервал дат своего отсутствия, удобные часы для проведения занятий и неподходящие дни недели. Также, им предлагалось ввести ссылки, по которым планируется проводить дистанционные аттестации. В данном случае эти ссылки - аналог аудиторий. Данные формы сохраняются в связанной с ней таблице, которая имела вид таблицы \ref{table:wishes}.

\begin{table}[htbp]
	\centering\small 
	\caption{Пожелания преподавателей к проведению сессии}
	\begin{tabular}{|p{0.05\linewidth}|p{0.02\linewidth}|p{0.02\linewidth}|p{0.07\linewidth}|p{0.07\linewidth}|p{0.02\linewidth}|p{0.02\linewidth}|p{0.08\linewidth}|p{0.02\linewidth}|p{0.02\linewidth}|}
		\hline
		Совм. & Дата с                          & Дата до                         & Имя   & Ассист.                & Отсутсвие с                     & Отсутствие до                   & Дни недели                    & час 1& час 2 \\ \hline
		Нет          &                                 &                                 & ФИО1  & ФИО13 & \multicolumn{1}{r|}{15.06.2021} & \multicolumn{1}{r|}{18.06.2021} &                               & 9                         & 18                        \\ \hline
		Нет          &                                 &                                 & ФИО7  &                           & \multicolumn{1}{r|}{08.06.2021} & \multicolumn{1}{r|}{18.06.2021} & Суббота                       & 10                        & 20                        \\ \hline
		Да           & \multicolumn{1}{r|}{14.06.2021} & \multicolumn{1}{r|}{19.06.2021} & ФИО10 &                           &                                 &                                 &                               & 10                        & 18                        \\ \hline
		Да           & \multicolumn{1}{r|}{10.06.2021} & \multicolumn{1}{r|}{30.06.2021} & ФИО13 &                           & \multicolumn{1}{r|}{17.06.2021} & \multicolumn{1}{r|}{18.06.2021} & Пятница, Суббота              & 9                         & 20                        \\ \hline
		Нет          &                                 &                                 & ФИО12 &                           &                                 &                                 &                               & 10                        & 20                        \\ \hline
		Да           & \multicolumn{1}{r|}{23.06.2021} & \multicolumn{1}{r|}{07.07.2021} & ФИО11 &                           &                                 &                                 & Пятница, Суббота & 10                        & 17                        \\ \hline
		Нет          &                                 &                                 & ФИО6  &                           &                                 &                                 & Суббота                       & 10                        & 20                        \\ \hline
		Нет          &                                 &                                 & ФИО9  &                           &                                 &                                 &                               & 11                        & 17                        \\ \hline
		Да           & \multicolumn{1}{r|}{07.06.2021} & \multicolumn{1}{r|}{28.06.2021} & ФИО3  &                           &                                 &                                 & Четверг, Суббота              & 10                        & 20                        \\ \hline
	\end{tabular}
\end{table} 	\label{table:wishes}
\FloatBarrier

Далее были выбраны даты проведения сессии, и сгенерировано расписание, выгруженное в google-таблицу. Оно представлено в таблице \ref{table:sched}. Данное расписание учитывает пожелания преподавателей, ограничения, связанные с типами аттестаций и временными рамками.

\begin{table}[htbp]
	\centering\small 
	\caption{Сгенерированное расписание сессии}%
	\begin{tabular}{|p{0.15\linewidth}|p{0.08\linewidth}|p{0.39\linewidth}|p{0.03\linewidth}|p{0.1\linewidth}|p{0.03\linewidth}|p{0.05\linewidth}|}
		\hline
		Группа         & ППС     & Дисциплина                                                    & Тип & Дата       & Час & Teams \\ \hline
		з3530903/70301 & {[}ФИО8{]}        & Проектная деятельность бакалавра                              & Зч  & 2021-06-17 & 12    & ...    \\ \hline
		з3530903/70301 & {[}ФИО10{]}       & Интеллектуальный анализ данных                                & Зч  & 2021-06-17 & 10    & ...    \\ \hline
		з3530903/70301 & {[}ФИО10{]}       & Интеллектуальный анализ данных                                & Эк  & 2021-06-18 & 10    & ...    \\ \hline
		з3530903/00001 & {[}ФИО2{]}        & Дополнительные главы программирования (C\#)                   & Эк  & 2021-06-21 & 11    & ...    \\ \hline
		з3530903/90001 & {[}ФИО6{]}        & Дискретная математика (дополнительные главы)                  & Зч  & 2021-06-21 & 10    & ...    \\ \hline
		з3530903/90002 & {[}ФИО6{]}        & Дискретная математика (дополнительные главы)                  & Зч  & 2021-06-21 & 12    & ...    \\ \hline
		з3530903/80301 & {[}ФИО13{]}       & Программирование веб-приложений (JS)                          & Зч  & 2021-06-21 & 9     & ...    \\ \hline
		з3530903/70301 & {[}ФИО9{]}        & Использование и разработка web-сервисов                       & Эк  & 2021-06-21 & 11    & ...    \\ \hline
		з3530903/90002 & {[}ФИО7{]}        & Учебная практика/Ознакомительная практика                     & Зч  & 2021-06-21 & 12    & ...    \\ \hline
		з3530903/90001 & {[}ФИО7{]}        & Учебная практика/Ознакомительная практика                     & Зч  & 2021-06-21 & 14    & ...    \\ \hline
		з3530903/00002 & {[}ФИО2{]}        & Дополнительные главы программирования (C\#)                   & Эк  & 2021-06-22 & 8     & ...    \\ \hline
		з3530903/80301 & {[}ФИО12{]}       & Архитектура вычислительных систем                             & Эк  & 2021-06-22 & 10    & ...    \\ \hline
		з3530903/70301 & {[}ФИО9{]}        & Использование и разработка web-сервисов                       & Зч  & 2021-06-23 & 8     & ...    \\ \hline
		з3530903/80301 & {[}ФИО11{]}       & Администрирование информационных систем (на английском языке) & Эк  & 2021-06-23 & 10    & ...    \\ \hline
		з3530903/70301 & {[}ФИО2{]}        & Производственная практика/Научно-исследовательская работа     & Зч  & 2021-06-24 & 8     & ...    \\ \hline
		з3530903/80301 & {[}ФИО7{]}        & Технологии разработки программного обеспечения (C\#)          & Эк  & 2021-06-24 & 10    & ...    \\ \hline
		з3530903/90001 & {[}ФИО3{]}        & Базы данных                                                   & Эк  & 2021-06-25 & 8     & ...    \\ \hline
		з3530903/90002 & {[}ФИО3{]}        & Базы данных                                                   & Эк  & 2021-06-25 & 13    & ...    \\ \hline
		з3530903/00001 & {[}ФИО13, ФИО1{]} & Дифференциальные уравнения                                    & Эк  & 2021-06-25 & 8     & ...    \\ \hline
		з3530903/00002 & {[}ФИО13, ФИО1{]} & Дифференциальные уравнения                                    & Эк  & 2021-06-25 & 13    & ...    \\ \hline
		з3530903/80301 & {[}ФИО13, ФИО1{]} & Теория вероятностей и математическая статистика               & Эк  & 2021-06-25 & 12    & ...    \\ \hline
		з3530903/70301 & {[}ФИО7{]}        & Проектирование информационных систем                          & Эк  & 2021-06-25 & 10    & ...    \\ \hline
		з3530903/90002 & {[}ФИО6{]}        & Структуры и алгоритмы обработки данных                        & Эк  & 2021-06-28 & 10    & ...    \\ \hline
		з3530903/90001 & {[}ФИО6{]}        & Структуры и алгоритмы обработки данных                        & Эк  & 2021-06-28 & 12    & ...    \\ \hline
	\end{tabular}
\end{table} \label{table:sched}
\FloatBarrier
\section{Выводы} \label{ch4:conclusion}

Система составления предварительного расписания сессии была успешно применена в СПбПУ при составлении расписания сессии и установочных занятий студентов заочной формы обучения, чем доказала, что может быть использована для составления расписаний любых разовых мероприятий, занимающих непрерывное время в течение дня. Это делает её очень полезной для составления расписания дополнительной сессии, так как ей занимается напрямую кафедра без участия дирекции института, а значит, в этом случае предварительное расписание можно рассматривать как основанное.

Как и было заявлено в требованиях, система автоматизирует сбор сведений от профессорско-преподавательского состава, а так же сама получает и учитывает данные из официального расписания СПбПУ. Ручное редактирование расписания доступно в нескольких форматах - финальные ручные правки админимстратрором в сгенерированной google-таблице, либо внесение установленных аттестаций в таблицу учёта, и генерация нового расписписания на её основе.

Из потенциальных улучшений, которые в будущем можно добавить в систему, можно назвать:
\begin{itemize}
	\item создание более надёжного модуля аутентификации;
	\item рассылка преподавателям напоминаний о том, что они не заполнили форму сбора сведений;
	\item открытие и рассылка готово расписания преподавателям;
	\item создание модуля навигации между сгенерированными таблицами и форма сбора сведений.
\end{itemize} 	

Добавление этих и других модулей не будет вынуждать разработчика переписывать много существующего кода, так как всё это отдельные блоки, которые можно легко встраивать в текущую систему.
